<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orders - Admin Dashboard</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="admin.css">
    <link rel="stylesheet" href="loading.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="admin-body">
    <!-- SIDEBAR -->
    <aside class="admin-sidebar" id="admin-sidebar">
        <div class="sidebar-header">
            <h1 class="sidebar-logo">üõí Hometown</h1>
            <span class="sidebar-badge">Admin</span>
        </div>
        
        <nav class="sidebar-nav">
            <a href="admin.html" class="sidebar-link">
                <span class="sidebar-icon">üìä</span>
                Dashboard
            </a>
            <a href="admin-orders.html" class="sidebar-link active">
                <span class="sidebar-icon">üì¶</span>
                Orders
                <span class="sidebar-count" id="pending-orders-count">3</span>
            </a>
            <a href="admin-products.html" class="sidebar-link">
                <span class="sidebar-icon">üõçÔ∏è</span>
                Products
            </a>
            <a href="admin-drivers.html" class="sidebar-link">
                <span class="sidebar-icon">üöó</span>
                Drivers
            </a>
            <a href="admin-customers.html" class="sidebar-link">
                <span class="sidebar-icon">üë•</span>
                Customers
            </a>
            <a href="admin-reports.html" class="sidebar-link">
                <span class="sidebar-icon">üìà</span>
                Reports
            </a>
            <a href="admin-email.html" class="sidebar-link">
                <span class="sidebar-icon">üìß</span>
                Email
            </a>
            <a href="admin-settings.html" class="sidebar-link">
                <span class="sidebar-icon">‚öôÔ∏è</span>
                Settings
            </a>
        </nav>
        
        <div class="sidebar-footer">
            <a href="index.html" class="sidebar-link">
                <span class="sidebar-icon">üåê</span>
                View Website
            </a>
        </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="admin-main">
        <header class="admin-topbar">
            <button class="mobile-sidebar-toggle" onclick="toggleAdminSidebar()">‚ò∞</button>
            <h2 class="topbar-title">Order Management</h2>
            <div class="topbar-right">
                <button class="btn btn-primary" onclick="openNewOrderModal()">
                    ‚ûï New Phone Order
                </button>
            </div>
        </header>

        <div class="admin-content">
            <!-- FILTERS -->
            <div class="filters-bar">
                <div class="filter-group">
                    <label>Status:</label>
                    <select class="form-input" id="filter-status" onchange="filterOrders()">
                        <option value="all">All Orders</option>
                        <option value="placed">üÜï New</option>
                        <option value="confirmed">‚úÖ Confirmed</option>
                        <option value="shopping">üõí Shopping</option>
                        <option value="delivering">üöó Delivering</option>
                        <option value="delivered">‚úîÔ∏è Delivered</option>
                        <option value="cancelled">‚ùå Cancelled</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label>Date:</label>
                    <select class="form-input" id="filter-date" onchange="filterOrders()">
                        <option value="today">Today</option>
                        <option value="yesterday">Yesterday</option>
                        <option value="week">This Week</option>
                        <option value="month">This Month</option>
                        <option value="all" selected>All Time</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label>Search:</label>
                    <input type="text" class="form-input" id="filter-search" placeholder="Order ID, name, phone..." onkeyup="filterOrders()">
                </div>
                
                <div class="filter-actions">
                    <button class="btn btn-outline" onclick="resetFilters()">Reset</button>
                    <button class="btn btn-outline" onclick="exportOrders()">üìÑ Export</button>
                </div>
            </div>

            <!-- ORDER STATS -->
            <div class="order-stats">
                <div class="order-stat">
                    <span class="order-stat-count" id="count-all">0</span>
                    <span class="order-stat-label">Total</span>
                </div>
                <div class="order-stat new">
                    <span class="order-stat-count" id="count-new">0</span>
                    <span class="order-stat-label">New</span>
                </div>
                <div class="order-stat in-progress">
                    <span class="order-stat-count" id="count-progress">0</span>
                    <span class="order-stat-label">In Progress</span>
                </div>
                <div class="order-stat delivered">
                    <span class="order-stat-count" id="count-delivered">0</span>
                    <span class="order-stat-label">Delivered</span>
                </div>
            </div>

            <!-- ORDERS TABLE -->
            <div class="table-container">
                <table class="data-table" id="orders-table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer</th>
                            <th>Items</th>
                            <th>Total</th>
                            <th>Status</th>
                            <th>Driver</th>
                            <th>Time</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="orders-table-body">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- EMPTY STATE -->
            <div class="empty-state" id="orders-empty" style="display: none;">
                <div class="empty-icon">üì¶</div>
                <h3>No Orders Found</h3>
                <p>No orders match your current filters.</p>
            </div>
        </div>
    </main>

    <!-- ORDER DETAIL MODAL -->
    <div class="modal-overlay" id="order-detail-modal">
        <div class="modal modal-large">
            <div class="modal-header">
                <h2>Order Details - <span id="modal-order-id"></span></h2>
                <button class="modal-close" onclick="closeModal('order-detail-modal')">√ó</button>
            </div>
            <div class="modal-body">
                <div class="order-detail-grid">
                    <!-- Customer Info -->
                    <div class="detail-section">
                        <h4>üë§ Customer Information</h4>
                        <div class="detail-row">
                            <span class="detail-label">Name:</span>
                            <span class="detail-value" id="detail-name"></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Phone:</span>
                            <span class="detail-value">
                                <a href="#" id="detail-phone-link"></a>
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Address:</span>
                            <span class="detail-value" id="detail-address"></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Email:</span>
                            <span class="detail-value" id="detail-email"></span>
                        </div>
                    </div>

                    <!-- Order Info -->
                    <div class="detail-section">
                        <h4>üì¶ Order Information</h4>
                        <div class="detail-row">
                            <span class="detail-label">Order Time:</span>
                            <span class="detail-value" id="detail-time"></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Delivery Preference:</span>
                            <span class="detail-value" id="detail-delivery-time"></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Payment:</span>
                            <span class="detail-value" id="detail-payment"></span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Notes:</span>
                            <span class="detail-value" id="detail-notes"></span>
                        </div>
                    </div>
                </div>

                <!-- Order Items -->
                <div class="detail-section">
                    <h4>üõí Order Items</h4>
                    <table class="items-table">
                        <thead>
                            <tr>
                                <th>Item</th>
                                <th>Price</th>
                                <th>Qty</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody id="detail-items">
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3">Subtotal</td>
                                <td id="detail-subtotal"></td>
                            </tr>
                            <tr>
                                <td colspan="3">Delivery</td>
                                <td>$6.99</td>
                            </tr>
                            <tr class="total-row">
                                <td colspan="3"><strong>Total</strong></td>
                                <td><strong id="detail-total"></strong></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>

                <!-- Status Update -->
                <div class="detail-section">
                    <h4>üîÑ Update Status</h4>
                    <div class="status-update-row">
                        <select class="form-input" id="update-status">
                            <option value="placed">üÜï New / Placed</option>
                            <option value="confirmed">‚úÖ Confirmed</option>
                            <option value="shopping">üõí Shopping</option>
                            <option value="delivering">üöó Out for Delivery</option>
                            <option value="delivered">‚úîÔ∏è Delivered</option>
                            <option value="cancelled">‚ùå Cancelled</option>
                        </select>
                        
                        <select class="form-input" id="assign-driver">
                            <option value="">Assign Driver...</option>
                        </select>
                        
                        <button class="btn btn-primary" onclick="updateOrderStatus()">Update</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="printOrder()">üñ®Ô∏è Print</button>
                <button class="btn btn-outline" onclick="callCustomer()">üìû Call Customer</button>
                <button class="btn btn-danger" onclick="cancelOrder()">‚ùå Cancel Order</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.socket.io/4.6.0/socket.io.min.js"></script>
    <script src="api.js"></script>
    <script src="auth.js"></script>
    <script src="main.js"></script>
    <script src="loading.js"></script>
    <script src="admin.js"></script>
</body>
</html>
